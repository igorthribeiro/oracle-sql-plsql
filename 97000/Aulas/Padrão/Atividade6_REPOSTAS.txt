/*
1 -CONSTRUA UMA QUERY QUE MOSTRE AS PESSOAS QUE POSSUEM O MESMO
GERENTE DE OUTRA (&SOBRENOME).
O RESULTADO DEVERÁ MOSTRAR:

 EMPLOYEE_ID, FIRST_NAME, MANAGER_ID
 
OBS.: A PESSOA NÃO DEVE APARECER NA LISTA
*/

UNDEFINE SOBRENOME;
SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, MANAGER_ID
  FROM EMPLOYEES
 WHERE MANAGER_ID = (SELECT MANAGER_ID FROM EMPLOYEES
                      WHERE UPPER(LAST_NAME) = UPPER('&&SOBRENOME'))
  AND  UPPER(LAST_NAME) <> UPPER('&SOBRENOME');                     
/*
2 - DESAFIO:
CONSTRUA UMA QUERY QUE MOSTRE O:
EMPLOYEE_ID, FIRST_NAME, LAST_NAME, DEPARTMENT_ID, SALARY
DOS EMPREGADOS QUE GANHAM ACIMA DA MÉDIA DO SEU DEPARTAMENTO. 
*/
SELECT E.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME,
       E.DEPARTMENT_ID, E.SALARY, ROUND(M.MED,2)
  FROM EMPLOYEES E JOIN (SELECT DEPARTMENT_ID, AVG(SALARY) MED
                           FROM EMPLOYEES
                       GROUP BY DEPARTMENT_ID) M
       ON E.DEPARTMENT_ID = M.DEPARTMENT_ID
      AND E.SALARY > M.MED; 











