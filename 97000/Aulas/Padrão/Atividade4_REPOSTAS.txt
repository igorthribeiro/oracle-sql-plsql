/*
1 - MONTE UMA QUERY QUE MOSTRE O ID DO DEPARTAMENTO, A QUANTIDADE
DE EMPREGADOS NESSE DEPARTAMENTO E A SOMA DOS SEU SALÁRIOS.
OS EMPREGADOS QUE SÃO SA_REP NÃO DEVEM SER CONTABILIZADOS.

DEPARTAMENTO | EMPREGADOS | SOMA_SALARIOS
     90      |     5      | R$ 15.000,00
*/

SELECT DEPARTMENT_ID DEPARTAMENTO,
       COUNT(*) EMPREGADOS,
       TO_CHAR(SUM(SALARY), 'fmL999G990D00') SOMA_SALARIOS
  FROM EMPLOYEES
  WHERE JOB_ID <> 'SA_REP'
 GROUP BY DEPARTMENT_ID;
 
/*
2 - DESAFIO: EM TODO ANO PAR ACONTECEM AS ELEIÇÕES NO BRASIL,
NO PRIMEIRO DOMINGO DO MÊS DE OUTUBRO.
MONTE UMA QUERY QUE MOSTRE O NOME DO EMPREGADO, O ANO QUE ELE
FOI ADMITIDO E A DATA DA ELEIÇÃO NO ANO DA SUA ADMISSÃO.

EMPREGADO  | ANO ADMISSÃO |  ELEIÇÃO
  IGOR 	   |     2016     |  02 de Outubro
  PAULO    |     2013     |  Não teve eleição
*/

SELECT FIRST_NAME, TO_CHAR(HIRE_DATE,'YYYY') ANO_ADMISSÃO,
       CASE
         WHEN MOD(TO_CHAR(HIRE_DATE,'YYYY'), 2) = 0 THEN
              TO_CHAR(NEXT_DAY('01/10'||TO_CHAR(HIRE_DATE,'YYYY'),1),'DD "de" Month')
         ELSE 'NÃO TEM ELEIÇÃO'
       END ELEIÇÃO
FROM EMPLOYEES;






 