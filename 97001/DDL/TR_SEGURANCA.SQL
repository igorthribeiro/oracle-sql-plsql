create or replace TRIGGER TR_SEGURANCA
   BEFORE INSERT OR UPDATE OR DELETE ON ALUNO
BEGIN
   IF (TO_CHAR(SYSDATE,'DY') IN ('SÁB','DOM')) OR
      (TO_CHAR(SYSDATE,'HH24:MI') NOT BETWEEN '08:00' AND '18:00') THEN
      
      IF INSERTING THEN  
         SP_GRAVA_LOG('TENTOU INSERIR ALUNOS FORA DO HORÁRIO OU DIA');
      ELSIF UPDATING THEN
         SP_GRAVA_LOG('TENTOU ALTERAR ALUNOS FORA DO HORÁRIO OU DIA');
      ELSIF DELETING THEN
         SP_GRAVA_LOG('TENTOU APAGAR ALUNOS FORA DO HORÁRIO OU DIA');
      ELSE 
         SP_GRAVA_LOG('TENTOU MANIPULAR ALUNOS FORA DO HORÁRIO OU DIA');
      END IF;

      RAISE_APPLICATION_ERROR(-20500, 'Você não pode alterar dados de alunos'||
                                      ' fora do horário de expediente!');
   END IF;
END;